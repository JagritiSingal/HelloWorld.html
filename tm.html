<!doctype html>
<html>
<head>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
    <h4>Production</h4>
    <div class="container-responsive">
        <div class="row" data-type="productionMegaCredit">
            <div class="col">MegaCredit</div>
            <div class="col">
                <div class="input-group">
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="-1">-</button></span>
                    <input type="number" class="form-control" min="-5" />
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="1">+</button></span>
                </div>
            </div>
        </div>
        <div class="row" data-type="productionSteel">
            <div class="col">Steel</div>
            <div class="col">
                <div class="input-group">
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="-1">-</button></span>
                    <input type="number" class="form-control" min="0" />
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="1">+</button></span>
                </div>
            </div>
        </div>
        <div class="row" data-type="productionTitanium">
            <div class="col">Titanium</div>
            <div class="col">
                <div class="input-group">
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="-1">-</button></span>
                    <input type="number" class="form-control" min="0" />
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="1">+</button></span>
                </div>
            </div>        </div>
        <div class="row" data-type="productionPlant">
            <div class="col">Plant</div>
            <div class="col">
                <div class="input-group">
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="-1">-</button></span>
                    <input type="number" class="form-control" min="0" />
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="1">+</button></span>
                </div>
            </div>
        </div>
        <div class="row" data-type="productionEnergy">
            <div class="col">Energy</div>
            <div class="col">
                <div class="input-group">
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="-1">-</button></span>
                    <input type="number" class="form-control" min="0" />
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="1">+</button></span>
                </div>
            </div>
        </div>
        <div class="row" data-type="productionHeat">
            <div class="col">Heat</div>
            <div class="col">
                <div class="input-group">
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="-1">-</button></span>
                    <input type="number" class="form-control" min="0" />
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="1">+</button></span>
                </div>
            </div>
        </div>
    </div>

    <h4>Resources</h4>

    <div class="container-responsive">
        <div class="row" data-type="currentMegaCredit">
            <div class="col">MegaCredit</div>
            <div class="col">
                <div class="input-group">
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="-1">-</button></span>
                    <input type="number" class="form-control" min="0" />
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="1">+</button></span>
                </div>
            </div>
        </div>
        <div class="row" data-type="currentSteel">
            <div class="col">Steel</div>
            <div class="col">
                <div class="input-group">
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="-1">-</button></span>
                    <input type="number" class="form-control" min="0" />
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="1">+</button></span>
                </div>
            </div>
        </div>
        <div class="row" data-type="currentTitanium">
            <div class="col">Titanium</div>
            <div class="col">
                <div class="input-group">
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="-1">-</button></span>
                    <input type="number" class="form-control" min="0" />
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="1">+</button></span>
                </div>
            </div>
        </div>
        <div class="row" data-type="currentPlant">
            <div class="col">Plant</div>
            <div class="col">
                <div class="input-group">
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="-1">-</button></span>
                    <input type="number" class="form-control" min="0" />
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="1">+</button></span>
                </div>
            </div>
        </div>
        <div class="row" data-type="currentEnergy">
            <div class="col">Energy</div>
            <div class="col">
                <div class="input-group">
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="-1">-</button></span>
                    <input type="number" class="form-control" min="0" />
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="1">+</button></span>
                </div>
            </div>
        </div>
        <div class="row" data-type="currentHeat">
            <div class="col">Heat</div>
            <div class="col">
                <div class="input-group">
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="-1">-</button></span>
                    <input type="number" class="form-control" min="0" />
                    <span class="btn-addon"><button class="btn btn-secondary" data-btn="1">+</button></span>
                </div>
            </div>
        </div>
        <hr/>
        <div class="row">
            <div class="col"><button type="button" class="btn btn-primary btn-block" onclick="nextGen();">Next Gen</button></div>
        </div>
        <hr/>
        <div class="row">
            <div class="col"><button type="button" class="btn btn-primary btn-block" onclick="prevGen();">Prev Gen</button></div>
        </div>
    </div>
    <script>
    if (!localStorage.values)
    {
        localStorage.values = "{}";
    }
    var map = ["MegaCredit", "Steel", "Titanium", "Plant", "Energy", "Heat"];
    var vals = JSON.parse(localStorage.values);
    document.addEventListener('DOMContentLoaded', function () {
        update();
    });
    document.addEventListener('click', function (e) {
        if (e.target.dataset.btn) {
            var c = e.target.closest("div.row");
            var id = c.dataset.type;
            vals[id] = parseInt(vals[id] || 0, 10) + parseInt(e.target.dataset.btn, 10);
            c.querySelector("input").value = vals[id];
            save();
        }
    });
    document.addEventListener('change', function (e) {
        var id = e.target.closest("div.row").getAttribute("data-type");
        vals[id] = e.target.value;
        save();
    });
    var update = function () {
        map.forEach((i) => {
            var el = document.querySelector("div.row[data-type='current" + i + "'] input");
            el.value = parseInt(vals["current" + i] || 0);
            var el = document.querySelector("div.row[data-type='production" + i + "'] input");
            el.value = parseInt(vals["production" + i] || 0);
        });
    };
    var save = function () {
        localStorage.values = JSON.stringify(vals);
    };
    var nextGen = function () {
        vals["lastEnergy"] = vals["lastEnergy"] || [];
        vals["lastEnergy"].push(vals["currentEnergy"] || 0);
        vals["currentHeat"] = parseInt(vals["currentHeat"] || 0, 10) + parseInt(vals["currentEnergy"] || 0, 10);
        vals["currentEnergy"] = 0;
        map.forEach((i) => {
            vals["current" + i] = parseInt(vals["current" + i] || 0, 10) + parseInt(vals["production" + i] || 0, 10);
        });
        update();
        save();
    };
    var prevGen = function () {
        var lastEnergy = (vals["lastEnergy"] || []).pop() || 0;
        vals["currentHeat"] = parseInt(vals["currentHeat"] || 0, 10) - lastEnergy;
        map.forEach((i) => {
            vals["current" + i] = parseInt(vals["current" + i] || 0, 10) - parseInt(vals["production" + i] || 0, 10);
        });
        vals["currentEnergy"] = lastEnergy;
        update();
        save();
    };
    </script>
</body>
</html>
